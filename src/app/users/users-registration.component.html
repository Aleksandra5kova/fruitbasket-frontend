<div class="container">

 <div class="row">
    <div class="col-md-6 col-md-offset-3 border">

          <a [routerLink]="['/users-sign-in']"><button class="btn btn-md btn-warning btn-block login" type="Submit">{{ 'goToLogin' | translate }}</button></a>

          <div class="page-header col-md-9 col-md-offset-1">
            <h2>{{ 'registration' | translate }}</h2>
          </div>

          <form #userForm="ngForm" >

              <div class="form-group">
                <div class="col-sm-10 col-md-offset-1">

                  <label for="email">{{ 'email' | translate }}</label>
                  <input type="email" id="email" name="email" class="form-control" [(ngModel)]="user.email" #email="ngModel" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}" required />
                  <button type="button" class="btn btn-link pull-right" (click)="checkEmail()">{{ 'checkEmailAvailability' | translate }}</button>

                  <div *ngIf="email.errors && (email.dirty || email.touched)">
                    <div class="errors" [hidden]="!email.errors.required">
                      {{ 'emailRequiered' | translate }}
                    </div>
                    <div class="errors" [hidden]="email.valid">
                      {{ 'emailValid' | translate }}
                    </div>
                  </div>
                  <div class="errors" [hidden]="!emailExist">
                      {{ 'emailExist' | translate }}
                   </div><br/>

                </div>
              </div>


              <div class="form-group">
                <div class="col-sm-10 col-md-offset-1">
                  <label for="username">{{ 'username' | translate}}</label>
                  <input type="text" id="username" name="username" class="form-control" [(ngModel)]="user.username" #username="ngModel" required minlength="6" maxlength="32"/>
                  <button type="button" class="btn btn-link pull-right" (click)="checkUsername()">{{ 'checkUsernameAvailability' | translate }}</button>

                  <div *ngIf="username.errors && (username.dirty || username.touched)">
                    <div class="errors" [hidden]="!username.errors.required">
                     {{ 'usernameRequiered' | translate }}
                    </div>
                    <div class="errors" [hidden]="!username.errors.minlength">
                      {{ 'usernameMinLength' | translate }}
                    </div>
                    <div class="errors" [hidden]="!username.errors.maxlength">
                      {{ 'usernameMaxLength' | translate }}
                    </div>
                  </div>
                  <div class="errors" [hidden]="!usernameExist">
                      {{ 'usernameExist' | translate }} 
                   </div>
                  <br/>
                  
                </div>
              </div>


              <div class="form-group">
                  <div class="col-sm-10 col-md-offset-1">
                    <label for="password">{{ 'password' | translate}}</label>
                    <input type="password" id="password" name="password" class="form-control" [(ngModel)]="user.password" #password="ngModel" required minlength="8" maxlength="32"/>

                    <div *ngIf="password.errors && (password.dirty || password.touched)">
                        <div class="errors" [hidden]="!password.errors.required">
                          {{ 'passwordRequiered' | translate }}
                        </div>
                        <div class="errors" [hidden]="!password.errors.minlength">
                          {{ 'passwordMinLength' | translate }}
                        </div>
                        <div class="errors" [hidden]="!password.errors.maxlength">
                           {{ 'passwordMaxLength' | translate }} 
                        </div>
                    </div><br/>

                  </div>
              </div>
            
              <div class="form-group">
                <div class="col-sm-10 col-md-offset-1">
                  <label for="passwordConfirm">{{ 'passwordConfirmation' | translate}}</label>
                  <input type="password" id="passwordConfirm" name="passwordConfirm" class="form-control" [(ngModel)]="passwordConfirmation" #passwordConfirm="ngModel" required minlength="8" maxlength="32"/>

                  <div *ngIf="passwordConfirm.errors && (passwordConfirm.dirty || passwordConfirm.touched)">
                      <div class="errors" [hidden]="!passwordConfirm.errors.required">
                          {{ 'passwordConfirmationRequiered' | translate }}
                      </div>
                      <div class="errors" [hidden]="!passwordConfirm.errors.minlength">
                         {{ 'passwordConfirmationMinLength' | translate }}
                        </div>
                        <div class="errors" [hidden]="!passwordConfirm.errors.maxlength">
                         {{ 'passwordConfirmationMaxLength' | translate }} 
                        </div>
                  </div>
                  <div class = "errors" *ngIf="passwordMismatch">
                        {{ 'passwordsEqual' | translate }} 
                  </div><br/>

                </div>
              </div>

              <div class="form-group">
                <div class="col-sm-10 col-md-offset-1">
                  <label>Language</label>
                  <div class="radio" *ngFor="let language of languages">
                    <label>
                      <input type="radio" name="language" [(ngModel)]="user.language" [value]="language.value">
                      {{language.display}}
                    </label>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <div class="col-sm-10 col-md-offset-1">
                  <div class="alert alert-danger" *ngIf="errors!= null && errors.length != 0">
                    <h4>{{ 'errors' | translate }}</h4>
                    <ul class="back-end-errors">
                        <li *ngFor="let error of errors">{{ error.defaultMessage | translate }}</li>
                    </ul>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <div class="col-sm-10 col-md-offset-1">
                  <div class="alert alert-danger text-center" *ngIf="error">
                    <p> {{ errorDesc | translate }} </p>
                  </div>
                </div>
              </div>

               <div class="form-group">
                <div class="col-sm-10 col-md-offset-1"><br/>
                    <button type="submit" class="btn btn-primary btn-block" [disabled]="!userForm.form.valid" (click)="saveUser()">{{ 'signUp' | translate }}</button>
                </div>
              </div>

          </form>
    </div>
  </div>
</div>

